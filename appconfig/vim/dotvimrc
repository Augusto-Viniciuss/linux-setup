set nocompatible              " be iMproved, required by Vundle
filetype off                  " required by Vundle
set t_Co=256        " 256 colors

set encoding=utf-8

"""""
""""" CONFIGURE VUNDLE PLUGIN MANAGER
"""""

" set the runtime path to include Vundle and initialize
set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin("~/.vim/VundlePlugins")

" let Vundle manage Vundle, required
Plugin 'VundleVim/Vundle.vim'

" A colorful, dark color scheme
Plugin 'nanotech/jellybeans.vim'

" A Vim plugin which shows a git diff in the 'gutter' (sign column).
Plugin 'airblade/vim-gitgutter'

" ifugitive.vim: a Git wrapper so awesome, it should be illegal
Plugin 'tpope/vim-fugitive'

" Lean & mean status/tabline for vim that's light as air.
Plugin 'bling/vim-airline'
Plugin 'vim-airline/vim-airline-themes'

" integration with tmux
Plugin 'benmills/vimux'

" code completion
Plugin 'ervandew/supertab'

" sharing registers between vims
Plugin 'ardagnir/united-front'

" file manager
Plugin 'scrooloose/nerdtree'

" home screen
Plugin 'mhinz/vim-startify'

" All of your Plugins must be added before the following line
call vundle#end()            " required by Vundle
filetype plugin indent on    " required by Vundle

"""""
""""" / CONFIGURE VUNDLE PLUGIN MANAGER
"""""

" some color stuff
set background=dark
set cursorline
set cursorcolumn
colorscheme jellybeans

" running airline
set laststatus=2					" allow running without splitting

" map the leader key
let mapleader = ","

" should fix colors in tmux
set term=screen-256color

" Run the current file with rspec
map <Leader>m :call VimuxRunCommand("cd ~/timepix_workspace; catkin build")<CR>
map <Leader>k :VimuxCloseRunner<CR>

" general vim settings
" more natural splits
set splitbelow
set splitright
"
" set line numbering
set number
"
" indention
set expandtab                   " tab inserts spaces
set shiftwidth=2
set softtabstop=2
set autoindent                  " copy the indention from the last line
set smartindent                 " sometimes indent extra indention
set tabstop=2                   " width of the tab character
"
"
set showmatch                   " brief jump to matching parent
set title
set nowrap                      " dont wrap text
"
" searching and patterns
set ignorecase
set smartcase
set hlsearch
set incsearch

hi Search guibg=LightBlue
hi Search ctermbg=NONE ctermfg=Yellow cterm=bold,underline

" Switch between relative and absolute line numbers with leader-N
function! NumberToggle()
  if(&relativenumber == 1)
    set nornu
  else
    set relativenumber
  endif
endfunc
nnoremap <leader>n :call NumberToggle()<cr>

" should fix colors in tmux
set term=screen-256color

" nerd tree toggle binding
map <C-n> :NERDTreeToggle<CR>

" turn on nerd tree if no file is specified
autocmd StdinReadPre * let s:std_in=1
autocmd VimEnter * if argc() == 1 && isdirectory(argv()[0]) && !exists("s:std_in") | exe 'NERDTree' argv()[0] | wincmd p | ene | wincmd h | endif
let NERDTreeQuitOnOpen=1  " close after opening a file

" CUSTOM Startify settings... TODO: finetune!
autocmd User Startified setlocal cursorline

let g:startify_enable_special         = 1
let g:startify_files_number           = 8
let g:startify_relative_path          = 1
let g:startify_change_to_dir          = 1
let g:startify_update_oldfiles        = 1
let g:startify_session_autoload       = 1
let g:startify_session_persistence    = 1
let g:startify_session_delete_buffers = 1

" should not show up in startify
let g:startify_skiplist = [
            \ 'COMMIT_EDITMSG',
            \ 'bundle/.*/doc',
            \ '/data/repo/neovim/runtime/doc',
            \ '/Users/mhi/local/vim/share/vim/vim74/doc',
            \ ]

" bookmarks in startify
let g:startify_bookmarks = [
            \ { 'b': '~/.bashrc' },
            \ { 'v': '~/.vimrc' },
            \ '~/someotherfile',
            \ ]

" the bottom part of the startify
let g:startify_custom_footer =
      \ ['', "   Pes štěká, kočka mňouká.", '']

hi StartifyBracket ctermfg=240
hi StartifyFile    ctermfg=147
hi StartifyFooter  ctermfg=240
hi StartifyHeader  ctermfg=114
hi StartifyNumber  ctermfg=215
hi StartifyPath    ctermfg=245
hi StartifySlash   ctermfg=240
hi StartifySpecial ctermfg=240

" load quotes for startify
source ~/.vim/../startify_quotes.txt
